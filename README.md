# Безопасность потоковых генераторов. Атака двухразовый блокнот.

Потоковый генератор в криптографии, также известный как потоковый шифр, используется для шифрования данных на основе потока данных или символов. В отличие от блочных шифров, которые обрабатывают данные блоками фиксированной длины, потоковые шифры работают с непрерывным потоком данных и шифруют каждый символ или бит по отдельности.

### Основные характеристики потоковых генераторов

1. **Псевдослучайные генераторы:** В основе потоковых шифров лежат псевдослучайные генераторы (PRNG), которые генерируют последовательности бит, кажущиеся случайными. Эти последовательности называются ключевыми потоками.

2. **Инициализирующий вектор (IV):** Для обеспечения уникальности шифрования при каждом использовании, часто используется инициализирующий вектор (IV). IV должен быть уникальным и, как правило, не требует секретности, но должен быть непредсказуемым.

3. **Алгоритм шифрования:** Потоковые шифры используют различные математические алгоритмы для генерации псевдослучайных последовательностей. Известные примеры включают RC4, Salsa20 и ChaCha20.

4. **Производительность:** Потоковые шифры, как правило, быстрее блочных шифров и имеют меньшие задержки, что делает их идеальными для приложений с высокими требованиями к скорости, таких как передача данных в реальном времени.

### Как работает потоковый генератор

1. **Ключ и IV:** Пользователь задает секретный ключ и инициализирующий вектор.
2. **Генерация ключевого потока:** Потоковый генератор использует ключ и IV для генерации псевдослучайного потока бит.
3. **Шифрование:** Каждый бит исходного сообщения побитно складывается по модулю 2 (операция XOR) с соответствующим битом ключевого потока.
4. **Дешифрование:** Процесс дешифрования идентичен процессу шифрования. Операция XOR с тем же ключевым потоком восстанавливает исходное сообщение.

### Примеры потоковых шифров

1. **RC4:** Один из наиболее известных потоковых шифров. Разработан Рональдом Ривестом в 1987 году. Использовался в протоколах, таких как SSL и WEP, но имеет известные уязвимости.
2. **Salsa20:** Быстрый потоковый шифр, разработанный Даниэлем Бернштейном. Обладает высокой производительностью и хорошей криптостойкостью.
3. **ChaCha20:** Улучшенная версия Salsa20, также разработанная Даниэлем Бернштейном. Используется в современных протоколах безопасности, таких как TLS 1.3.

### Преимущества и недостатки потоковых шифров

**Преимущества:**
- Высокая скорость шифрования и дешифрования.
- Эффективность при шифровании потоков данных в реальном времени.
- Простота реализации.

**Недостатки:**
- Чувствительность к повторному использованию ключа или IV. Повторное использование может привести к компрометации безопасности.
- Некоторые потоковые шифры имеют известные уязвимости (например, RC4).

### Применение потоковых генераторов

Потоковые шифры широко используются в различных приложениях, где необходима высокая скорость шифрования и обработка данных в реальном времени. Примеры включают:

- Шифрование данных в беспроводных сетях (например, WEP, хотя сейчас заменен на более безопасные протоколы).
- Шифрование данных в протоколах передачи голоса и видео в реальном времени.
- Приложения, где важна минимальная задержка при обработке данных.

Потоковые шифры остаются важной частью современных криптографических систем, обеспечивая надежное и быстрое шифрование для разнообразных приложений.

### Атаки на потоковый шифр

+ Двухразовый блокнот 

$$
m_1 \neq m_2
$$

$$
c_1=m_1 \oplus G(k) \quad \oplus \quad c_2=m_2\oplus G(k)
$$

$$
c_1\oplus c_2=m_1\oplus m_2
$$

$$
\underbrace{c_1\oplus c_2}_{\text{Ева знает}}=
$$

$$
\underbrace{m_1\oplus m_2}_{\text{не является псевдослучайными данными}}
$$

Генератор псевдослучайных чисел - запускается один раз, а затем разбивается на части псевдослучайных последовательностей разных сообщений. 

---

<br>

802.11b WEB (Wered Equivalent Privacy) 128 bit

```
client                            точка доступа
            |m    |   CRC (m)|
                            xor
            |   PRG(IV||k)   |
            IV  |      ШТ    |

```

|| - конкатинация (слепление)

номер кадра - 24 бит (чистый инкремент, это плохо, потому что у этих ключей в префиксе отличается только один бит, а суффик остается неизменным) (решение - как можно реже менять ключ)

$2^{24} \approx 16,000,000$ кадров $=>$ двухразовый блокнот


+ Нарушение целостности

Потоковые шифры никак не защищены от модификаций

`Модификации ШТ не обнаруживаются и имеют предсказуемое, прямое вляние на ОТ`

```
m = FROM Bob --------	o  /F/R/O/M/ /B/o/b/ --	o  ШТ
                enc                            |
                                     xor       |
                                               |
                                              
```

---

<br>






