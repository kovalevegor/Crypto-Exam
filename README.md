# Идея блочных шифров. Их назначение. Принцип итерирования. Понятие псевдослучайной функции и псевдослучайной перестановки

*Блочный шифр (block cipher)* - это функция шифрования, которая применяется к блокам текста фиксированной длины. Текущее поколение блочных шифров работает с блоками текста длиной 128 бит (16 байт). Такой шифр принимает на вход 128-битовый открытый текст и выдает 128-битовый шиф- рованный текст. Блочный шифр является обратимым: существует функция дешифрования, которая принимает на вход 128-битовый шифрованный текст и выдает исходный 128-битовый открытый текст. Открытый и шифрованный текст всегда имеет один и тот же размер, который называется размером блока (block size).

Чтобы зашифровать сообщение, нужен секретный ключ. Невозможно скрыть сообщение, не сохраняя что-нибудь в секрете. Подобно открытому и шифрованному тексту, ключ шифрования также представляет собой строку битов. Наиболее распространены ключи размером 128 и 256 бит. Шифрование открытого текста p при помощи ключа K принято обозначать как $E(K, p)$ или $E_K(p)$z`, а расшифровку шифрованного текста c при помощи ключа $K - D(K, c)$ или $D_K(c)$ .

```
n bit              n bit        
 OT <---> E, D <---> ШТ
           |
           |
           k 
```

```
--------- k ---------
 | Расширение ключа |
---------------------
|    |     |        |
k1   k2   k3   ...  ks
```


`Лавинный эффект` - если меняется один бит ключа, то изменятся биты в подавляющем большенстве ключей 

$F$ - функция раунда, может использоваться в обратном порядке

$$
\text{ОТ } \to F_0(k_1, m) \to F_1(K_2, F_0) \dots F_s(k_s, F_{s-1}) \to \text{ ШТ (c)}
$$

---

<br>

### Классические примеры

**AES:** *Advanced Encryption Standart* 2002 (Линейно-алгебраический)

+ длина блока (n) - 128 bit
+ длина кшлюча (k) - 128, 192, 256 bit
+ количество раундов (S) - 10, 12, 14

**3DES:**

+ длина блока (n) - 64 bit
+ длина кшлюча (k) - 168 bit $3\times 56$
+ количество раундов (S) - 16


**ГОСТ 28147-89:** (Deprecated)

+ длина блока (n) - 64 bit
+ длина кшлюча (k) - 256 bit
+ количество раундов (S) - 32

**ГОСТ 3412-2018:** 

Шифр: МАГМА (совместим с ГОСТ 28147-89)

Шифр: Кузнечик: (Линейно-алгебраический)

+ длина блока (n) - 128 bit
+ длина кшлюча (k) - 256 bit
+ количество раундов (S) - 10

Тятробезопасность

--- 

<br>

Где используется блочное шифрование: 

+ Шифрование данный по времени
+ Генератор случайных чисел
+ Целостность сообщений
+ Построение хеш-функция SHA(KAL)-256


`Псевдослучайная функция` - PRF $F: K\times X \to Y$ $\exists$ эффективный алгоритм вычисления $F(k,x)$(действует на паре множества )

`Псевдослучайная перестановка` - PRP $E: K\times X \to X$ должна удовлетворять условиям: 

+ $\exists$ эффективный алгоритм вычисления $E(k, x)
+ $E(k, \bullet)$ биекция при фиксированном $k$
+ $\exists$ эффективный алгоритм вычисления $E^{-1}(k, x)$ (обратное)

Огромное множество кубиков

Все функции, которые работают $F: K\times X \to Y$/ Количество всех возможных функций = $\vert Y \vert ^ {\vert X \vert}$

Смысл работы - Ева не поймет разницы выхода очередного кубика случайной функции от выхода алгоритма.  

**Пример**

$F$ - псевдослучайная функция $F:K\times X\to X$, где $X=\lbrace 0,1\rbrace ^{128}$

---





