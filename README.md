# Теоретически-стойкий шифр. Определение генератора псевдослучайных последовательностей

<br>

## Теоретически стойкий шифр (идеальный шифр)

**Определение** 

$$
\forall m_0m_1: |m_0| = |m_1|
$$

$$
\forall c \in C
$$

$$
P_r[E(k,m_0)=c]=P_r[E(k,m_1)=c]
$$

---

*one time pad*  -   Теоритически стойкий шифр

$$
\forall m, c
$$

$$
P_r[E(k,m)=c]=\frac{\\#K:E(k,m) = c}{|K|} \=> \frac{1}{2^n}
$$

#K - количество ключей для данного шифрования

|K| - простраснство ключей 

**теоритический стойкий шифр**, если $|K|\ge|M|$

<br>

### Шифр Вернама 
(одноразовый блокнот) *OTP - one time pad*  -   Теоритически стойкий шифр

Tекст преобразовали в последовательность бит

$$
M = \lbrace 0, 1 \rbrace ^n 
$$

$$
C = \lbrace 0, 1 \rbrace ^n
$$

$$
K = \lbrace 0, 1 \rbrace ^n
$$

$$
E: m \oplus k = c
$$

$$
D: c \oplus k = m
$$

---

Об абсолютной стойкости (или теоретической стойкости) говорят в случае, если криптосистема не может быть раскрыта ни теоретически, ни практически даже при наличии у атакующего бесконечно больших вычислительных ресурсов. Доказательство существования абсолютно стойких алгоритмов шифрования было выполнено Клодом Шенноном и опубликовано в работе «Теория связи в секретных системах». Там же определены требования к такого рода системам:

+ ключ генерируется для каждого сообщения (каждый ключ используется только один раз)
+ ключ статистически надёжен (то есть вероятности появления каждого из возможных символов равны, символы в ключевой последовательности независимы и случайны)
+ длина ключа равна или больше длины сообщения
+ исходный (открытый) текст обладает некоторой избыточностью (что является критерием оценки правильности расшифровки)

Стойкость этих систем **не зависит** от того, какими вычислительными возможностями обладает криптоаналитик. Практическое применение систем, удовлетворяющих требованиям абсолютной стойкости, ограничено соображениями стоимости и удобства пользования.

Шенноном было доказано, что примером абсолютно стойкого алгоритма является шифр Вернама (одноразовый блокнот). Иными словами, корректное использование шифра Вернама не даёт злоумышленнику никакой информации об открытом тексте (любой бит сообщения он может лишь угадать с вероятностью $\dfrac{1}{2}$ .

---

## Генератор псевдослучайных чисел

Альтернативой истинно случайным числам являются так называемые псевдослучайные числа. В действительности псевдослучайные числа вообще не являются случайными. Они вычисляются с помощью детерминированно- го алгоритма на основе некоторого начального числа (`seed`). Зная начальное число, можно предсказать все последующие псевдослучайные числа. Класси- ческие генераторы псевдослучайных чисел (`pseudorandom number generator` - `PRNG`) никак не защищены от умного злоумышленника. Они разрабатыва- лись для устранения статистических искажений, а вовсе не для того, чтобы отражать атаки. 


**PRC** - генератор псевдо случайных чисел 

$G: \underbrace{\lbrace 0,1 \rbrace S}_{Seed}\to \lbrace 0,1 \rbrace ^n$ , seed $S\gg n$

$$
K=\lbrace 0,1 \rbrace ^S \qquad M = C = \lbrace 0,1 \rbrace ^n
$$

seed -битовая последовательность длины S

```
                    K
                  /  \
                /      \
              /          \
        ------------------------
        |         G(k)         |
        ------------------------
                   xor
        ------------------------
        |           m          |
        ------------------------
        ________________________
        ------------------------
        |           c          |
        ------------------------
      
```

Мы должны исходить из предположения, что наш противник знает алгоритм, используемый для генерации случайных чисел. Может ли злоумышленник, зная несколько псевдослучайных чисел, сгенерированных алгоритмом, предугадать некоторые биты будущих (или прошлых) случайных значений? Для большинства классических генераторов псевдослучайных чисел ответ может быть положительным. Для криптографических генераторов псевдослучайных чисел это недопустимо.

В контексте криптографической системы к генераторам псевдослучайных чисел предъявляются гораздо более строгие требования. Даже если злоумышленник знает целый ряд случайных чисел, созданных генератором, у него не должно быть возможности предугадать какую-либо информацию об остальных случайных числах. Мы называем такой генератор псевдослучайных чисел криптографически сильным. 

<br>

Представим PRG - предсказуем (значит по данным можно предсказать следующие данные)

Существуют различные формы атак на генераторы псевдослучайных чи- сел. Прежде всего следует отметить прямую атаку, где злоумышленник пы- тается воссоздать внутреннее состояние генератора на основе его выходных данных. Это классический тип криптоатаки, которому довольно легко про- тивостоять, используя современные приемы криптографии.


$$
\exists i \space G(k) [1, \dots, i-1] \to G(k) [1, \dots, n]
$$

Алгоритм А (владеет им Ева) 

```
Ева знает первые байты ОТ
Как Ева по данным первых
бит достраивает генератор
и находит открытый текст
        ------------------------
        |           c          |  \
        ------------------------    \
xor                                   \
        ------------------------        x
m       |   ...   |    ....    |      /
        ------------------------    /
        |   G(k)  |            |  /
        |[1...i-1]|............|
               \     /
                 \ /
                  A
```

**Определение предсказуемого генератора** 

PRG - $G: \lbrace 0,1 \rbrace ^S\to\lbrace 0,1 \rbrace ^n$ называется предсказуемым, если $\exists A$ "эффективный" $\exists\space 1\le i\le n-1$

$$
Pr[A(G(k)[1\dots i-1]=G(k)[i]] > \frac{1}{2}+\varepsilon
$$

Если $\frac{1}{2}+\varepsilon$ , то $\varepsilon$ начимое 

$$
\varepsilon> \dfrac{1}{2^{30}}
$$

---
