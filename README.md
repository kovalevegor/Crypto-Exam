# Шифр DES. Описание структуры. Cеть Фейстеля.

### DES

Алгоритм шифрования DES (Data Encryption Standard - стандарт шиф- рования данных), незаменимая рабочая лошадка криптографии, наконец-то перешагнул черту пенсионного возраста. Ограничения на размер ключа в 56 бит и размер блока в 64 бит делают DES непригодным для современных высокоскоростных компьютеров и огромных объемов данных. Он все еще может применяться в виде “тройного” DES или 3DES - блочного шифра, образованного путем трех последовательных применений алгоритма DES. Это решает наиболее острую проблему малого размера ключа, однако не позволяет снять ограничение на малый размер блока. По современным стандартам DES - не особенно быстрый шифр, а 3DES работает еще в три раза медленнее. Несмотря на все это, DES до сих пор используется во многих существующих системах, однако применять DES или 3DES в новых разработках не рекомендуется.

```
 L                                                                R  
 |                                        Ki                      |
 |                                        |                       |
 |    |-----------------------------------|-----------------------| 
 |    |                                   |                   F   |
 |    |                                   |                       |
XOR <--- Перестановка битов <--- S  <--- XOR  <--- Расширение <---
      |                                                           |  
      |------------------------------------------------------------
      \                                                           / 
         \                                                     /
            \                                               /
                 ------------------------------------->          
                 <-------------------------------------
```

На вход алгоритма DES подается 64-битовый блок открытого текста, ко- торый разбивается на две 32-битовые половины: L (левая) и R (правая). Перед этим биты исходного блока текста подвергаются начальной перестановке по полуупорядоченному принципу. Никто не может толком объяснить, зачем разработчики шифра DES решили переставить биты открытого текста - ведь это не имеет никакого криптографического эффекта; однако алгоритм DES определен именно так. По окончании шифрования левая и правая половины вновь объединяются и подвергаются обратной перестановке, в результате чего вновь получается 64-битовый блок текста, однако на сей раз шифрованного.

Алгоритм DES состоит из 16 раундов, которые обозначаются цифрами от 1 до 16. Каждый раунд i преобразует пару (L, R) в новую пару (L, R) с помощью подключа Ki. Б´ольшую часть преобразования выполняет функ- ция раунда F (на рис. 4.1 она обведена штриховой рамкой). Как показано на рисунке, вначале к значению R применяется функция расширения. Она дублирует 16 битов значения R, в результате чего 32-битовое значение пре- вращается в 48-битовое. Этот результат функции расширения складывается с помощью операции XOR с 48-битовым подключом Ki. Результат этой опе- рации подается на вход S-матриц. По своей сути S-матрица (буква S озна- чает substitution, т.е. подстановка) - это всего лишь таблица соответствий. Поскольку мы не можем построить таблицу соответствий для 48-битовых данных, S-матрицы состоят из восьми небольших таблиц соответствий, каж- дая из которых получает на вход 6 бит и выдает 4-битовый результат. Таким образом, после преобразования 48-битового значения с помощью S-матриц, мы вновь получаем 32-битовое значение. Последнее подвергается еще одной перестановке битов, после чего складывается с помощью операции XOR с ле- вой половиной L. И наконец, значения правой и левой половины меняются местами. Эта процедура повторяется еще 15 раз.









