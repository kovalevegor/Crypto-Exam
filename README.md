# Определение статистического теста. Соответствие непредсказуемости и безопасности потоковых генераторов.

## Критерий хорошего статистического теста
Через вероятность различить полследовательности

Пусть $G:K\to\lbrace 0,1 \rbrace ^n$ и $A$ - статистический тест

$$
Adv_{PRG}[A,G]=\vert Pr[A(\underbrace{G(k)}_{k\in K})=1]-Pr[A(\underbrace{r}_r\in\lbrace 0,1 \rbrace ^n)=1]\vert
$$

```python
if Adv 	->  1:
  A отмечает G(k) от случайной последовательности
if Adv 	->  0:
  A не отличает G(k) от случайной последовательности
```

### Примеры использования критерия статистического теста

1. $A(x) = 0 => Adv_{PRG}[A,G]=0$

2. $G:k\to\lbrace 0,1\rbrace ^n$ $\dfrac{2}{3}$ последовательностей `msb(G(k)) = 1`, `msb` - первый бит

$$ A(x)=\begin{cases}
0 &\text{иначе} \\ 
1 &\text{is msb(G(k))=1}
\end{cases}
$$ 

$$
Adv_{PRG}[A,G]=\vert\dfrac{2}{3}-\dfrac{1}{2}\vert=\dfrac{1}{6}\to\text{ значение}
$$

---

<br>

**Теорема** *Безопасный генератор не предсказуем*

*Если хотя бы один бит является предсказуемым, то генератор небезопасен*
```python
if генератор предсказуем 	->  он небезопасен
```

+ r - случайное 
+ Pr[B(r) = 1] = $\dfrac{1}{2}$ 
+ Pr[G(k)] = $\dfrac{1}{2} + \varepsilon$

Доказательство:

$$
Adv_{PRG}[B,G]=\vert Pr[B(G(k))=1]-Pr[B(r)=1]\vert
$$

### Задача

+ $G:K	\to \lbrace 0, 1 \rbrace ^n$ - безопасный генератор
+ $G': K \times K 	\to   \lbrace 0, 1 \rbrace ^n$
+ $G'(K_1, K_2) = G(K_1) \\& G(K_2)$ - увеличения длины ключа.
+ Безопасен ли такой генератор?


$Adv_{PRG}[A,G']= \vert Pr[A(r)=1]-Pr[A(G'(K_1,K_2))=1]\vert = \dfrac{1}{4}$

Ответ: генератор не безопасен

Конъюнкция и Дизъюнкция - "плохие" булевые функции для битовых операций

---

### Задача

+ $G:K	\to  \lbrace 0, 1 \rbrace ^n$ - безопасный генератор
+ $G':K	\to   \lbrace 0, 1 \rbrace ^{n-2}$ - works like $G'[K)=G(K)[1\dots n-2]$ - безопасен?
Adv - эффективность
Доказательство от противного: 

1. Допустим $G'$ -небезопасен, тогда $\forall \space A \space Adv[A,G']>\varepsilon$

$$
B(X) = \begin\{cases}
   0 & \text{}\\
   1 & \text{if} \space A (X_{[1\dots n-1]}) = 1
\end{cases}
$$

2. $Adv_{PRG}[B,G] = Pr[B(r)=1]=\dfrac{1}{2}$
3. $Pr(B(G(k))=1]=\varepsilon$
4. $Adv_{PRG}[B,G]=\vert \dfrac{1}{2}-t\vert > \varepsilon$











